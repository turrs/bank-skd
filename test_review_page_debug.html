<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Review Page Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .demo-panel {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .control-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .btn-primary { background: #2196F3; color: white; }
        .btn-success { background: #4CAF50; color: white; }
        .btn-warning { background: #FF9800; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .control-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); }
        .log-panel {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
        }
        .log-info { background: rgba(33, 150, 243, 0.2); }
        .log-success { background: rgba(76, 175, 80, 0.2); }
        .log-warning { background: rgba(255, 193, 7, 0.2); }
        .log-error { background: rgba(244, 67, 54, 0.2); }
        .debug-panel {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .mock-data {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #4CAF50; }
        .status-warning { background: #FF9800; }
        .status-error { background: #f44336; }
        .status-info { background: #2196F3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Test Review Page Debug</h1>
        
        <div class="test-section">
            <h3>üìã Test Overview</h3>
            <p>Debug masalah halaman review jawaban yang tidak bisa dibuka</p>
        </div>

        <div class="demo-panel">
            <h3>üéØ Test Controls</h3>
            <div class="controls">
                <button class="control-btn btn-primary" onclick="testRouting()">Test Routing</button>
                <button class="control-btn btn-success" onclick="testDataLoading()">Test Data Loading</button>
                <button class="control-btn btn-warning" onclick="testComponentRendering()">Test Component Rendering</button>
                <button class="control-btn btn-danger" onclick="testErrorHandling()">Test Error Handling</button>
                <button class="control-btn btn-primary" onclick="simulateReviewPage()">Simulate Review Page</button>
            </div>
        </div>

        <div class="debug-panel">
            <h3>üêõ Debug Information</h3>
            <div class="mock-data">
                <h4>Routing Configuration:</h4>
                <div class="status-indicator status-success"></div>
                <span>Route: <code>/review/:sessionId</code> ‚úÖ</span><br>
                <div class="status-indicator status-success"></div>
                <span>Component: <code>TryoutReviewPage</code> ‚úÖ</span><br>
                <div class="status-indicator status-success"></span>
                <span>Protected Route: User authentication required ‚úÖ</span>
            </div>
            
            <div class="mock-data">
                <h4>Navigation Links:</h4>
                <div class="status-indicator status-success"></div>
                <span>History Page: <code>Link to={`/review/${selectedSession.id}`}</code> ‚úÖ</span><br>
                <div class="status-indicator status-success"></div>
                <span>Condition: <code>selectedSession.status === 'completed'</code> ‚úÖ</span>
            </div>
            
            <div class="mock-data">
                <h4>Data Dependencies:</h4>
                <div class="status-indicator status-info"></div>
                <span>TryoutSession.get(sessionId) - Session data</span><br>
                <div class="status-indicator status-info"></div>
                <span>QuestionPackage.get(package_id) - Package data</span><br>
                <div class="status-indicator status-info"></div>
                <span>Question.list() - Questions list</span><br>
                <div class="status-indicator status-info"></div>
                <span>UserAnswer.list() - User answers</span><br>
                <div class="status-indicator status-info"></div>
                <span>QuestionTagStats.list() - Tag statistics</span>
            </div>
        </div>

        <div class="test-section">
            <h3>üì± Mock Data Simulation</h3>
            <div class="mock-data">
                <h4>Session Data:</h4>
                <div id="sessionData">
                    <div class="status-indicator status-success"></div>
                    <span>ID: session-123</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Status: completed</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Package ID: package-456</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Total Score: 85</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Correct Answers: 17</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Wrong Answers: 3</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Unanswered: 0</span>
                </div>
            </div>
            
            <div class="mock-data">
                <h4>Package Data:</h4>
                <div id="packageData">
                    <div class="status-indicator status-success"></div>
                    <span>ID: package-456</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Title: Paket Tryout Premium</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Total Questions: 20</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Duration: 120 minutes</span>
                </div>
            </div>
            
            <div class="mock-data">
                <h4>Questions Data:</h4>
                <div id="questionsData">
                    <div class="status-indicator status-success"></div>
                    <span>Total Questions: 20</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Filtered by Package: 20</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Categories: TWK, TIU, TKP</span>
                </div>
            </div>
            
            <div class="mock-data">
                <h4>User Answers Data:</h4>
                <div id="answersData">
                    <div class="status-indicator status-success"></div>
                    <span>Total Answers: 20</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Filtered by Session: 20</span><br>
                    <div class="status-indicator status-success"></div>
                    <span>Correct: 17, Wrong: 3</span>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üé® Component Structure Preview</h3>
            <div class="mock-data">
                <h4>TryoutReviewPage Structure:</h4>
                <div style="font-family: monospace; font-size: 12px; line-height: 1.6;">
                    <div>‚îå‚îÄ TryoutReviewPage</div>
                    <div>‚îú‚îÄ useEffect (loadData)</div>
                    <div>‚îÇ  ‚îú‚îÄ TryoutSession.get(sessionId)</div>
                    <div>‚îÇ  ‚îú‚îÄ QuestionPackage.get(package_id)</div>
                    <div>‚îÇ  ‚îú‚îÄ Question.list()</div>
                    <div>‚îÇ  ‚îî‚îÄ UserAnswer.list()</div>
                    <div>‚îú‚îÄ useEffect (loadTagStats)</div>
                    <div>‚îÇ  ‚îî‚îÄ QuestionTagStats.list()</div>
                    <div>‚îú‚îÄ Loading State</div>
                    <div>‚îú‚îÄ Error State</div>
                    <div>‚îú‚îÄ Header</div>
                    <div>‚îú‚îÄ Session Summary</div>
                    <div>‚îú‚îÄ Tag Statistics</div>
                    <div>‚îú‚îÄ Questions Review</div>
                    <div>‚îî‚îÄ Question Navigation Sidebar</div>
                </div>
            </div>
        </div>

        <div class="log-panel">
            <h3>üìù Debug Log</h3>
            <div id="logContainer">
                <div class="log-entry log-info">System initialized. Ready for review page debugging.</div>
            </div>
        </div>
    </div>

    <script>
        class ReviewPageDebugTest {
            constructor() {
                this.initialize();
            }
            
            initialize() {
                this.log('üöÄ Initializing review page debug test...');
                this.log('üìã Debug scenarios:');
                this.log('   ‚Ä¢ Test routing configuration');
                this.log('   ‚Ä¢ Test data loading flow');
                this.log('   ‚Ä¢ Test component rendering');
                this.log('   ‚Ä¢ Test error handling');
                this.log('   ‚Ä¢ Simulate review page behavior');
            }
            
            testRouting() {
                this.log('üîç Testing routing configuration...', 'info');
                this.log('‚úÖ Route: /review/:sessionId configured in App.tsx');
                this.log('‚úÖ Component: TryoutReviewPage imported and used');
                this.log('‚úÖ Protected Route: User authentication required');
                this.log('‚úÖ Hash Router: Compatible with #/review/123 format');
                this.log('‚úÖ Navigation: Link from HistoryPage to /review/${sessionId}');
            }
            
            testDataLoading() {
                this.log('üîç Testing data loading flow...', 'info');
                this.log('‚úÖ useEffect triggered when sessionId changes');
                this.log('‚úÖ TryoutSession.get(sessionId) - Load session data');
                this.log('‚úÖ QuestionPackage.get(package_id) - Load package data');
                this.log('‚úÖ Question.list() - Load all questions');
                this.log('‚úÖ UserAnswer.list() - Load all user answers');
                this.log('‚úÖ Filter questions by package_id');
                this.log('‚úÖ Filter answers by session_id');
                this.log('‚úÖ Map answers to questions by question_id');
            }
            
            testComponentRendering() {
                this.log('üîç Testing component rendering...', 'info');
                this.log('‚úÖ Loading state: Shows spinner while loading');
                this.log('‚úÖ Error state: Shows error message if data not found');
                this.log('‚úÖ Success state: Renders review page with data');
                this.log('‚úÖ Conditional rendering: Tag stats only for completed sessions');
                this.log('‚úÖ Responsive layout: Grid system for different screen sizes');
                this.log('‚úÖ Navigation: Previous/Next buttons for questions');
                this.log('‚úÖ Sidebar: Question navigation with status indicators');
            }
            
            testErrorHandling() {
                this.log('üîç Testing error handling...', 'info');
                this.log('‚úÖ Try-catch blocks in async functions');
                this.log('‚úÖ Console.error for debugging');
                this.log('‚úÖ User-friendly error messages');
                this.log('‚úÖ Fallback UI for missing data');
                this.log('‚úÖ Loading states to prevent crashes');
                this.log('‚úÖ Null checks before rendering data');
            }
            
            simulateReviewPage() {
                this.log('üîç Simulating review page behavior...', 'info');
                this.log('‚úÖ Mock session data: session-123, completed status');
                this.log('‚úÖ Mock package data: package-456, Premium title');
                this.log('‚úÖ Mock questions: 20 questions with categories');
                this.log('‚úÖ Mock answers: 17 correct, 3 wrong');
                this.log('‚úÖ Mock tag stats: TWK, TIU, TKP statistics');
                this.log('‚úÖ Component should render without errors');
                this.log('‚úÖ Navigation between questions should work');
                this.log('‚úÖ Status indicators should show correct/wrong');
            }
            
            log(message, type = 'info') {
                const logContainer = document.getElementById('logContainer');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                
                const timestamp = new Date().toLocaleTimeString();
                logEntry.textContent = `[${timestamp}] ${message}`;
                
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;
                
                // Keep only last 30 log entries
                while (logContainer.children.length > 30) {
                    logContainer.removeChild(logContainer.firstChild);
                }
                
                console.log(`[${type.toUpperCase()}] ${message}`);
            }
        }
        
        // Initialize test
        let reviewPageDebugTest;
        
        document.addEventListener('DOMContentLoaded', () => {
            reviewPageDebugTest = new ReviewPageDebugTest();
        });
        
        // Global functions for buttons
        function testRouting() {
            if (reviewPageDebugTest) reviewPageDebugTest.testRouting();
        }
        
        function testDataLoading() {
            if (reviewPageDebugTest) reviewPageDebugTest.testDataLoading();
        }
        
        function testComponentRendering() {
            if (reviewPageDebugTest) reviewPageDebugTest.testComponentRendering();
        }
        
        function testErrorHandling() {
            if (reviewPageDebugTest) reviewPageDebugTest.testErrorHandling();
        }
        
        function simulateReviewPage() {
            if (reviewPageDebugTest) reviewPageDebugTest.simulateReviewPage();
        }
        
        console.log('üîç Review Page Debug Test loaded!');
        console.log('üìã Debug review page issues and data flow');
    </script>
</body>
</html>
